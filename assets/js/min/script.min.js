(function(e,t,n){e.Site={basePath:t.body.getAttribute("data-base-url"),userAgent:navigator.userAgent,platform:navigator.platform};var r=t.documentElement;r.setAttribute("data-useragent",Site.userAgent);r.setAttribute("data-platform",Site.platform);String.prototype.queryToObj=function(e){e=e||!1;var t,n="",r={},i=0,s;typeof e=="string"&&(n=this.replace(e,""));t=n.split("&"),s=t.length;for(i;i<s;i++){var o=t[i].split("="),u=o[0],a=o[1];r[u]=a}return r};var i={vroom:function(e){e=e||!1;if(e===!1){console.error("Douchebag supplied false arguments");return}this.kickTires(e).lightFires().pedalToTheMetal();return this},pedalToTheMetal:function(){$.get(Site.basePath+"/portfolio.php",this.readyWork);var e="https://api.github.com/users/adamcbrewer/repos?callback=?&type=owner";$.getJSON(e,this.readyGit)},readyWork:function(e){i.work=e.work;i.about=e.about;i[404]=e[404];i.hazWork=!0;i.checkReadyState()},readyGit:function(e){i.hazGit=!0;i.checkReadyState()},checkReadyState:function(){if(this.hazWork){this.relax();if(this.deeplink)this.openProject(this.deeplink);else if(this.search){var e=this.parseSearch(this.search);e.page&&this.openPage(e.page);e.project&&this.openProject(e.project)}}},busy:function(){this.$body.addClass("busy")},relax:function(){this.$body.removeClass("busy")},openProject:function(e){this.busy();var t=this,n=this.work[e],r="";if(n){r=this.projectTmpl.render(n);this.pushState("project",e)}else{var i=Math.floor(Math.random()*this[404].length);r=this.fourZeroFourTmpl.render(this[404][i]);this.pushState("page","404")}this.$detail.html(r);t.$body.addClass("detail-open");imagesLoaded(this.$detail[0],function(){t.relax();t.$detail.find(".project").removeClass("hide")})},openPage:function(e){e=e||!1;this.busy();var t=this[e],n="";if(e==="work"){this.close();this.pushState(!1)}else if(e==="404"){this.openProject("wat");this.pushState(!1)}else if(e==="about"){n=this.aboutTmpl.render(t);this.$detail.html(n);this.$body.addClass("detail-open");this.$detail.find(".hide").removeClass("hide");this.pushState("page",e)}this.relax()},close:function(){this.$body.removeClass("detail-open");this.$detail.find(".project").addClass("hide");this.$detail.html("");this.pushState(!1);e.scrollTo(0,0)},toggleView:function(){this.$body.toggleClass("listview")},parseSearch:function(e){var t=e.queryToObj("?");return t},pushState:function(t,n){if(this.hasPushstate){if(arguments[0]===!1||arguments[0]===!0){var r=Site.basePath;r.substr(-1,1)!=="/"&&(r+="/");e.history.pushState(null,"",r);return}var i=e.location.search,s=i.queryToObj("?"),o,u=!1;i+=i.indexOf("?")==-1?"?":"";for(o in s){var a=s.hasOwnProperty(o);if(a&&s[o]===n){u=!0;break}}if(!u){i="?"+t+"="+n;var f={};f[t]=n;e.history.pushState(f,i,i)}}},kickTires:function(t){this.$body=t.body;this.$detail=t.detail;this.projectTmpl=Hogan.compile(t.projectTmpl);this.fourZeroFourTmpl=Hogan.compile(t.fourZeroFourTmpl);this.aboutTmpl=Hogan.compile(t.aboutTmpl);this.hazWork=!1;this.hazGit=!1;this.hasPushstate=!!e.history&&!!history.pushState;this.deeplink=t.deeplink;this.search=t.search;return this},lightFires:function(){var t=this.$body;t.on("click",".projectlist-item",function(e){var t=this,n=t.getAttribute("data-project");i.openProject(n)});t.on("keydown",function(e){var t=e.keyCode;t===27&&i.close();t===9&&i.toggleView()});t.on("click","[data-open-page]",function(e){e.preventDefault();var t=this,n=t.getAttribute("data-open-page");i.openPage(n)});this.hasPushstate&&(e.onpopstate=function(t){e.location.search.indexOf("?")!=-1});return this}};Zepto(function(t){var n=!1,r=e.location.hash,s=e.location.search,o={};if(r.length){r.indexOf("#!")!==-1?r=r.replace("#!",""):r=r.replace("#","");n=r.replace("/","")}else s.length&&(o=s);i.vroom({body:t("body"),detail:t(".detail"),projectTmpl:t("#tProject").html(),fourZeroFourTmpl:t("#tFourZeroFour").html(),aboutTmpl:t("#tAbout").html(),deeplink:n,search:o})})})(window,document);